{"version":3,"sources":["views/Bond/components/ExchangeModal.tsx","hooks/useCatchError.ts","views/Bond/components/ExchangeCard.tsx","components/Spacer/Spacer.tsx","views/Bond/components/ExchangeStat.tsx","hooks/useBondsPurchasable.ts","grape-finance/constants.ts","views/Bond/BondEstimatorModal.js","views/Bond/Bond.tsx","state/transactions/hooks.tsx","components/ModalActions/ModalActions.tsx","hooks/useApprove.ts","components/Input/Input.tsx","components/TokenInput/TokenInput.tsx","components/UnlockWallet/UnlockWallet.tsx","hooks/useAllowance.ts","components/Button/Button.tsx","0x.ts","hooks/useBondStats.ts","hooks/useCashPriceInLastTWAP.ts"],"names":["ExchangeModal","_ref","max","title","description","onConfirm","onDismiss","action","tokenName","_useState","useState","_useState2","_slicedToArray","val","setVal","fullBalance","useMemo","getFullDisplayBalance","handleChange","useCallback","e","currentTarget","value","handleSelectMax","_jsxs","Modal","children","_jsx","ModalTitle","text","TokenInput","onSelectMax","onChange","symbol","Label","ModalActions","Button","onClick","useCatchError","addPopup","useAddPopup","promise","message","arguments","length","undefined","catch","err","includes","console","error","concat","stack","StyledCardTitle","styled","div","_templateObject","_taggedTemplateLiteral","props","theme","spacing","StyledCardIcon","_templateObject2","StyledExchanger","_templateObject3","StyledExchangeArrow","_templateObject4","StyledToken","_templateObject5","StyledCardActions","_templateObject6","StyledDesc","span","_templateObject7","StyledCardContentInner","_templateObject8","ExchangeCard","fromToken","fromTokenName","toToken","toTokenName","priceDesc","onExchange","_ref$disabled","disabled","disabledDescription","catchError","Treasury","useGrapeFinance","contracts","_useApprove","useApprove","address","approveStatus","approve","balance","useTokenBalance","_useModal","useModal","_useModal2","onPresent","Card","CardContent","TokenSymbol","width","height","color","FontAwesomeIcon","icon","faArrowRight","ApprovalState","APPROVED","className","PENDING","UNKNOWN","StyledSpacer","size","Spacer","s","_ref$size","useContext","ThemeContext","grey","ExchangeStat","price","useBondsPurchasable","BigNumber","from","setBalance","grapeFinance","useEffect","_fetchBondsPurchasable","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","t0","getBondsPurchasable","t1","sent","t2","stop","apply","fetchBondsPurchasable","DECIMALS_18","pow","BOND_REDEEM_PRICE_BN","mul","useStyles","makeStyles","textField","fontSize","subTitle","fontWeight","greenText","inputButton","marginLeft","borderRadius","background","border","outline","padding","lineHeight","cursor","input","appearance","paddingBlock","backgroundColor","WebkitAppearance","MozAppearance","style","position","top","left","transform","bgcolor","p","display","flexDirection","boxSizing","BondEstimatorModal","open","walletBondAmount","handleClose","bondAmount","setBondAmount","_useState3","_useState4","twap","setTwap","classes","_useState5","_useState6","ratio","setRatio","_useState7","_useState8","grapeRedeemed","setGrapeRedeemed","Number","toFixed","updateCalculation","Box","sx","justifyContent","CloseIcon","Typography","mt","alignItems","mb","type","target","Grid","container","direction","item","StyledBond","StyledCardWrapper","StyledStatsWrapper","Bond","account","useWallet","addTransaction","useTransactionAdder","bondStat","useBondStats","cashPrice","useCashPriceInLastTWAP","bondsPurchasable","bondBalance","GBOND","memoizedBondBalance","handleBuyBonds","amount","tx","buyBonds","summary","_x","handleRedeemBonds","_ref2","_callee2","_context2","redeemBonds","_x2","isBondRedeemable","gt","isBondPurchasable","tokenInFtm","grapeReserves","treasuryGrapes","bondSupply","circulatingSupply","bondScale","modalOpen","setModalOpen","Switch","Page","_Fragment","Math","align","variant","gutterBottom","marginBottom","xs","sm","justify","margin","Alert","severity","MetarialBox","gap","SwapVerticalCircleIcon","GRAPE","getDisplayBalance","roundAndFormatNumber","UnlockWallet","_useWallet","chainId","dispatch","useDispatch","response","approval","hash","Error","useAllTransactions","_state$chainId","state","useSelector","transactions","useHasPendingApproval","tokenAddress","spender","allTransactions","Object","keys","some","receipt","Date","getTime","addedTime","isTransactionRecent","StyledModalActions","StyledModalAction","l","React","Children","toArray","map","child","i","APPROVE_AMOUNT","ethers","constants","MaxUint256","APPROVE_BASE_AMOUNT","token","pendingApproval","currentAllowance","useAllowance","lt","NOT_APPROVED","abrupt","publish","StyledInputWrapper","StyledInput","Input","endAdornment","placeholder","startAdornment","StyledTokenInput","StyledTokenAdornmentWrapper","StyledMaxText","toLocaleString","AccountButton","allowance","setAllowance","fetchAllowance","StyledButton","button","boxShadow","StyledLink","Link","StyledExternalLink","a","buttonColor","buttonSize","buttonPadding","href","to","_useContext","teal","primary","main","ButtonChild","precision","rounded","multiplier","round","formatted","inputNumber","ret","toString","expr","indexOf","replace","split","right","formatNumber","stat","setStat","slowRefresh","useRefresh","_fetchBondPrice","getBondStat","fetchBondPrice","setPrice","fetchCashPrice","getGrapePriceInLastTWAP","refreshInterval","setInterval","config","clearInterval"],"mappings":"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","file":"static/js/21.5693d0b8.chunk.js","sourcesContent":["import React, {useCallback, useMemo, useState} from 'react';\nimport Button from '../../../components/Button';\nimport Modal, {ModalProps} from '../../../components/Modal';\nimport ModalActions from '../../../components/ModalActions';\nimport ModalTitle from '../../../components/ModalTitle';\nimport TokenInput from '../../../components/TokenInput';\nimport {getFullDisplayBalance} from '../../../utils/formatBalance';\nimport {BigNumber} from 'ethers';\nimport Label from '../../../components/Label';\n\ninterface ExchangeModalProps extends ModalProps {\n  max: BigNumber;\n  onConfirm: (amount: string) => void;\n  title: string;\n  description: string;\n  action: string;\n  tokenName: string;\n}\n\nconst ExchangeModal: React.FC<ExchangeModalProps> = ({\n  max,\n  title,\n  description,\n  onConfirm,\n  onDismiss,\n  action,\n  tokenName,\n}) => {\n  const [val, setVal] = useState('');\n  const fullBalance = useMemo(() => getFullDisplayBalance(max), [max]);\n\n  const handleChange = useCallback((e: React.FormEvent<HTMLInputElement>) => setVal(e.currentTarget.value), [setVal]);\n\n  const handleSelectMax = useCallback(() => {\n    setVal(fullBalance);\n  }, [fullBalance, setVal]);\n\n  return (\n    <Modal>\n      <ModalTitle text={title} />\n      <TokenInput\n        value={val}\n        onSelectMax={handleSelectMax}\n        onChange={handleChange}\n        max={fullBalance}\n        symbol={tokenName}\n      />\n      <Label text={description} />\n      <ModalActions>\n        <Button text=\"Cancel\" onClick={onDismiss} />\n        <Button text={action} onClick={() => onConfirm(val)} />\n      </ModalActions>\n    </Modal>\n  );\n};\n\nexport default ExchangeModal;\n","import {useCallback} from 'react';\nimport {useAddPopup} from '../state/application/hooks';\n\nconst DEFAULT_ERROR_MSG = 'Unexpected error is occurred.';\n\nfunction useCatchError(): (promise: Promise<any>, message?: string) => void {\n  const addPopup = useAddPopup();\n\n  return useCallback(\n    (promise: Promise<any>, message = DEFAULT_ERROR_MSG) => {\n      promise.catch((err) => {\n        if (err.message.includes('User denied')) {\n          // User denied transaction signature on MetaMask.\n          return;\n        }\n        console.error(`Uncaught exception: ${err.stack}`);\n        addPopup({error: {message, stack: err.stack}});\n      });\n    },\n    [addPopup],\n  );\n}\n\nexport default useCatchError;\n","//@ts-nocheck\nimport React from 'react';\nimport styled from 'styled-components';\n\nimport {Button, Card} from '@material-ui/core';\n\n// import Button from '../../../components/Button';\n// import Card from '../../../components/Card';\nimport CardContent from '../../../components/CardContent';\nimport useGrapeFinance from '../../../hooks/useGrapeFinance';\nimport Label from '../../../components/Label';\nimport TokenSymbol from '../../../components/TokenSymbol';\nimport {FontAwesomeIcon} from '@fortawesome/react-fontawesome';\nimport {faArrowRight} from '@fortawesome/free-solid-svg-icons';\nimport useModal from '../../../hooks/useModal';\nimport ExchangeModal from './ExchangeModal';\nimport ERC20 from '../../../grape-finance/ERC20';\nimport useTokenBalance from '../../../hooks/useTokenBalance';\nimport useApprove, {ApprovalState} from '../../../hooks/useApprove';\nimport useCatchError from '../../../hooks/useCatchError';\n\ninterface ExchangeCardProps {\n  action: string;\n  fromToken: ERC20;\n  fromTokenName: string;\n  toToken: ERC20;\n  toTokenName: string;\n  priceDesc: string;\n  onExchange: (amount: string) => void;\n  disabled?: boolean;\n  disabledDescription?: string;\n}\n\nconst ExchangeCard: React.FC<ExchangeCardProps> = ({\n  action,\n  fromToken,\n  fromTokenName,\n  toToken,\n  toTokenName,\n  priceDesc,\n  onExchange,\n  disabled = false,\n  disabledDescription,\n}) => {\n  const catchError = useCatchError();\n  const {\n    contracts: {Treasury},\n  } = useGrapeFinance();\n  const {approveStatus, approve} = useApprove(fromToken, Treasury.address);\n\n  const balance = useTokenBalance(fromToken);\n  const [onPresent, onDismiss] = useModal(\n    <ExchangeModal\n      title={action}\n      description={priceDesc}\n      max={balance}\n      onConfirm={(value) => {\n        onExchange(value);\n        onDismiss();\n      }}\n      action={action}\n      tokenName={fromTokenName}\n    />,\n  );\n  return (\n    <Card>\n      <CardContent>\n        <StyledCardContentInner>\n          \n          <StyledCardTitle>{`${action} ${toTokenName}`}</StyledCardTitle>\n          <StyledExchanger>\n            <StyledToken>\n              <StyledCardIcon>\n                <TokenSymbol width={55} height={50} symbol={fromToken.symbol} />\n              </StyledCardIcon>\n              <Label text={fromTokenName} color=\"#930993\" />\n            </StyledToken>\n            <StyledExchangeArrow>\n              <FontAwesomeIcon icon={faArrowRight} />\n            </StyledExchangeArrow>\n            <StyledToken>\n              <StyledCardIcon>\n                <TokenSymbol width={55} height={50} symbol={toToken.symbol} />\n              </StyledCardIcon>\n              <Label text={toTokenName} color=\"#930993\" />\n            </StyledToken>\n          </StyledExchanger>\n          <StyledDesc>{priceDesc}</StyledDesc>\n          <StyledCardActions>\n            {approveStatus !== ApprovalState.APPROVED && !disabled ? (\n              <Button\n                className=\"shinyButton\"\n                disabled={approveStatus === ApprovalState.PENDING || approveStatus === ApprovalState.UNKNOWN}\n                onClick={() => catchError(approve(), `Unable to approve ${fromTokenName}`)}\n              >\n                {`Approve ${fromTokenName}`}\n              </Button>\n            ) : (\n              <Button\n                className={disabled ? 'shinyButtonDisabled' : 'shinyButton'}\n                onClick={onPresent}\n                disabled={disabled}\n              >\n                {disabledDescription || action}\n              </Button>\n            )}\n          </StyledCardActions>\n        </StyledCardContentInner>\n      </CardContent>\n    </Card>\n  );\n};\n\nconst StyledCardTitle = styled.div`\n  align-items: center;\n  display: flex;\n  font-size: 20px;\n  font-weight: 700;\n  height: 64px;\n  justify-content: center;\n  color: #ccf;\n  margin-top: ${(props) => -props.theme.spacing[3]}px;\n`;\n\nconst StyledCardIcon = styled.div`\n  background-color: rgba(0,0,0,0.2);\n  width: 80px;\n  height: 80px;\n  border-radius: 36px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: ${(props) => props.theme.spacing[2]}px;\n`;\n\nconst StyledExchanger = styled.div`\n  align-items: center;\n  display: flex;\n  margin-bottom: ${(props) => props.theme.spacing[5]}px;\n`;\n\nconst StyledExchangeArrow = styled.div`\n  font-size: 20px;\n  padding-left: ${(props) => props.theme.spacing[3]}px;\n  padding-right: ${(props) => props.theme.spacing[3]}px;\n  padding-bottom: ${(props) => props.theme.spacing[4]}px;\n`;\n\nconst StyledToken = styled.div`\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  font-weight: 600;\n`;\n\nconst StyledCardActions = styled.div`\n  display: flex;\n  justify-content: center;\n  margin-top: ${(props) => props.theme.spacing[3]}px;\n  width: 100%;\n`;\n\nconst StyledDesc = styled.span``;\n\nconst StyledCardContentInner = styled.div`\n  align-items: center;\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  justify-content: space-between;\n`;\n\nexport default ExchangeCard;\n","import React, {useContext} from 'react';\nimport styled, {ThemeContext} from 'styled-components';\n\ninterface SpacerProps {\n  size?: 'sm' | 'md' | 'lg';\n}\n\nconst Spacer: React.FC<SpacerProps> = ({size = 'md'}) => {\n  const {spacing} = useContext(ThemeContext);\n\n  let s: number;\n  switch (size) {\n    case 'lg':\n      s = spacing[6];\n      break;\n    case 'sm':\n      s = spacing[2];\n      break;\n    case 'md':\n    default:\n      s = spacing[4];\n  }\n\n  return <StyledSpacer size={s} />;\n};\n\ninterface StyledSpacerProps {\n  size: number;\n}\n\nconst StyledSpacer = styled.div<StyledSpacerProps>`\n  height: ${(props) => props.size}px;\n  width: ${(props) => props.size}px;\n`;\n\nexport default Spacer;\n","import React from 'react';\nimport styled from 'styled-components';\n\nimport {Card} from '@material-ui/core';\n\ninterface ExchangeStatProps {\n  tokenName: string;\n  description: string;\n  price: string;\n}\n\nconst ExchangeStat: React.FC<ExchangeStatProps> = ({tokenName, description, price}) => {\n  return (\n    <Card>\n      <StyledCardContentInner>\n        <StyledCardTitle>{`ðŸ’° ${tokenName} = ${price}`}</StyledCardTitle>\n        <StyledDesc>{description}</StyledDesc>\n      </StyledCardContentInner>\n    </Card>\n  );\n};\n\nconst StyledCardTitle = styled.div`\n  font-size: 20px;\n  font-weight: 700;\n  margin-bottom: ${(props) => props.theme.spacing[2]}px;\n`;\n\nconst StyledDesc = styled.span`\n  //color: ${(props) => props.theme.color.grey[300]};\n  text-align: center;\n`;\n\nconst StyledCardContentInner = styled.div`\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  padding: ${(props) => props.theme.spacing[2]}px;\n`;\n\nexport default ExchangeStat;\n","import { useEffect, useState} from 'react';\nimport {BigNumber} from 'ethers';\nimport useGrapeFinance from './useGrapeFinance';\n\nconst useBondsPurchasable = () => {\n  const [balance, setBalance] = useState(BigNumber.from(0));\n  const grapeFinance = useGrapeFinance();\n\n  useEffect(() => {\n    async function fetchBondsPurchasable() {\n      try {\n        setBalance(await grapeFinance.getBondsPurchasable());\n      } catch (err) {\n        console.error(err);\n      }\n    }\n    fetchBondsPurchasable();\n  }, [setBalance, grapeFinance]);\n\n  return balance;\n};\n\nexport default useBondsPurchasable;\n","import {BigNumber} from 'ethers';\n\nexport const DECIMALS_18 = BigNumber.from(10).pow(14);\n\nexport const BOND_REDEEM_PRICE = 1.01;\nexport const BOND_REDEEM_PRICE_BN = DECIMALS_18.mul(101).div(100);\n","import {Modal, Grid, GridItem, Box, Typography, makeStyles} from '@material-ui/core';\nimport React, {useEffect, useState} from 'react';\nimport CloseIcon from '@material-ui/icons/Close';\n\nconst useStyles = makeStyles((theme) => ({\n  textField: {\n    color: 'black',\n    '& *': {\n      color: 'black',\n    },\n  },\n  text: {\n    fontSize: '14px',\n  },\n  subTitle: {\n    color: '#fff',\n    fontSize: '14px',\n    fontWeight: 'bold',\n  },\n  greenText: {\n    color: '#36d846',\n    fontSize: '14px',\n  },\n  inputButton: {\n    marginLeft: '8px',\n    fontSize: '12px',\n    borderRadius: '4px',\n    background: '#0c7aca',\n    border: 'none',\n    outline: 'none',\n    padding: '0px 4px',\n    lineHeight: '24px',\n    color: 'white',\n    cursor: 'pointer',\n  },\n  input: {\n    appearance: 'none',\n    border: 'none',\n    outline: 'none',\n    padding: 'none',\n    width: '100%',\n    paddingBlock: '5px',\n    backgroundColor: 'transparent',\n    '&::-webkit-outer-spin-button, &::-webkit-inner-spin-button': {\n      WebkitAppearance: 'none',\n    },\n    '&[type=number]': {\n      MozAppearance: 'none',\n    },\n  },\n}));\n\nconst style = {\n  position: 'absolute',\n  top: '50%',\n  color: '#fff',\n  left: '50%',\n  transform: 'translate(-50%, -50%)',\n  width: 'min(90%, 450px)',\n  bgcolor: 'rgba(0,0,0,0.8)',\n  p: '24px',\n  display: 'flex',\n  flexDirection: 'column',\n  outline: 'none',\n  boxSizing: 'border-box',\n  borderRadius: '12px',\n};\n\nconst BondEstimatorModal = ({open, walletBondAmount, handleClose}) => {\n  const [bondAmount, setBondAmount] = useState(walletBondAmount);\n  const [twap, setTwap] = useState(1.1);\n\n  const classes = useStyles();\n\n  const [ratio, setRatio] = useState(1);\n  const [grapeRedeemed, setGrapeRedeemed] = useState(\"1\");\n\n  const updateCalculation = (bondAmount, twap) => {\n    const coeff = 0.7\n    const ratio = 1 + ((Number(twap) - 1) * coeff)\n    setRatio(ratio.toFixed(3))\n    setGrapeRedeemed((Number(bondAmount) * ratio).toFixed(2))\n  };\n\n  useEffect(() => {\n    updateCalculation(bondAmount, twap)\n  }, [open, walletBondAmount, handleClose, bondAmount, twap])\n\n  return (\n    <Modal open={open}>\n      <Box sx={style}>\n        <Box\n          sx={{\n            display: 'flex',\n            justifyContent: 'flex-end',\n          }}\n        >\n          <Box\n            sx={{\n              cursor: 'pointer',\n            }}\n            onClick={() => {\n              handleClose();\n              setBondAmount(walletBondAmount);\n            }}\n          >\n            <CloseIcon />\n          </Box>\n        </Box>\n        <Box\n          sx={{\n            display: 'flex',\n            flexDirection: 'column',\n          }}\n        >\n          <Typography className={classes.text}>Enter GBonds amount:</Typography>\n          <Box\n            sx={{\n              borderRadius: '10px',\n              bgcolor: '#eff2f4',\n              border: '1px solid #d0d3d4',\n              p: '10px',\n              mt: '10px',\n            }}\n          >\n            <Box\n              sx={{\n                display: 'flex',\n                flexDirection: 'row',\n                alignItems: 'center',\n                mb: '10px',\n              }}\n            >\n              <input\n                type=\"text\"\n                value={bondAmount}\n                className={classes.input}\n                onChange={(e) => {\n                  setBondAmount(e.target.value);\n                  // updateCalculation(e.target.value, twap);\n                }}\n              />\n            </Box>\n          </Box>\n        </Box>\n        <Box\n          mt={1}\n          sx={{\n            display: 'flex',\n            flexDirection: 'column',\n          }}\n        >\n          <Typography className={classes.text}>Enter Grape TWAP:</Typography>\n          <Box\n            sx={{\n              borderRadius: '10px',\n              bgcolor: '#eff2f4',\n              border: '1px solid #d0d3d4',\n              p: '10px',\n              mt: '10px',\n            }}\n          >\n            <Box\n              sx={{\n                display: 'flex',\n                flexDirection: 'row',\n                alignItems: 'center',\n                mb: '10px',\n              }}\n            >\n              <input\n                type=\"number\"\n                value={twap}\n                className={classes.input}\n                onChange={(e) => {\n                  setTwap(e.target.value);\n                  // updateCalculation(bondAmount, e.target.value);\n                }}\n              />\n            </Box>\n          </Box>\n        </Box>\n        <Box mt={3}>\n          <Grid container direction=\"column\">\n            <Grid item>\n              <Grid container justifyContent=\"space-between\">\n                <Grid item>TWAP</Grid>\n                <Grid item>\n                  <b>{twap}</b>\n                </Grid>\n              </Grid>\n            </Grid>\n            <Grid item>\n              <Grid container justifyContent=\"space-between\">\n                <Grid item>GBonds amount</Grid>\n                <Grid item>\n                  <b>{Number(bondAmount).toFixed(2)}</b>\n                </Grid>\n              </Grid>\n            </Grid>\n            <Grid item>\n              <Grid container style={{color: '#930993'}} justifyContent=\"space-between\">\n                <Grid item>Ratio</Grid>\n                <Grid item>\n                  <b>1 / {ratio}</b>\n                </Grid>\n              </Grid>\n            </Grid>\n            <Grid item>\n              <Grid container style={{color: '#930993'}} justifyContent=\"space-between\">\n                <Grid item>Grapes redeemed</Grid>\n                <Grid item>\n                  <b>{grapeRedeemed}</b>\n                </Grid>\n              </Grid>\n            </Grid>\n          </Grid>\n        </Box>\n      </Box>\n    </Modal>\n  );\n};\n\nexport default BondEstimatorModal;\n","//@ts-nocheck\nimport React, {useCallback, useMemo, useState} from 'react';\nimport Page from '../../components/Page';\nimport {createGlobalStyle} from 'styled-components';\nimport {Route, Switch, useRouteMatch} from 'react-router-dom';\nimport {useWallet} from 'use-wallet';\nimport UnlockWallet from '../../components/UnlockWallet';\nimport ExchangeCard from './components/ExchangeCard';\nimport styled from 'styled-components';\nimport Spacer from '../../components/Spacer';\nimport useBondStats from '../../hooks/useBondStats';\nimport useGrapeFinance from '../../hooks/useGrapeFinance';\nimport useCashPriceInLastTWAP from '../../hooks/useCashPriceInLastTWAP';\nimport {useTransactionAdder} from '../../state/transactions/hooks';\nimport ExchangeStat from './components/ExchangeStat';\nimport useTokenBalance from '../../hooks/useTokenBalance';\nimport useBondsPurchasable from '../../hooks/useBondsPurchasable';\nimport {getDisplayBalance} from '../../utils/formatBalance';\nimport {BOND_REDEEM_PRICE, BOND_REDEEM_PRICE_BN} from '../../grape-finance/constants';\nimport {Alert} from '@material-ui/lab';\nimport {roundAndFormatNumber} from '../../0x';\nimport BondEstimatorModal from './BondEstimatorModal';\nimport SwapVerticalCircleIcon from '@material-ui/icons/SwapVerticalCircle';\n\nimport HomeImage from '../../assets/img/background.jpg';\nimport {Grid, Typography, Box} from '@material-ui/core';\nimport {Box as MetarialBox} from '@mui/material';\n\nconst Bond: React.FC = () => {\n  const {account} = useWallet();\n  const grapeFinance = useGrapeFinance();\n  const addTransaction = useTransactionAdder();\n  const bondStat = useBondStats();\n  const cashPrice = useCashPriceInLastTWAP();\n\n  const bondsPurchasable = useBondsPurchasable();\n\n  const bondBalance = useTokenBalance(grapeFinance?.GBOND);\n  const memoizedBondBalance = useMemo(() => {\n    return bondBalance != null && Number(bondBalance) > 0 ? bondBalance : null;\n  }, [bondBalance]);\n\n  const handleBuyBonds = useCallback(\n    async (amount: string) => {\n      const tx = await grapeFinance.buyBonds(amount);\n      addTransaction(tx, {\n        summary: `Buy ${Number(amount).toFixed(2)} GBOND with ${amount} GRAPE`,\n      });\n    },\n    [grapeFinance, addTransaction],\n  );\n\n  const handleRedeemBonds = useCallback(\n    async (amount: string) => {\n      const tx = await grapeFinance.redeemBonds(amount);\n      addTransaction(tx, {summary: `Redeem ${amount} GBOND`});\n    },\n    [grapeFinance, addTransaction],\n  );\n\n  const isBondRedeemable = useMemo(() => cashPrice.gt(BOND_REDEEM_PRICE_BN), [cashPrice]);\n  const isBondPurchasable = useMemo(() => Number(bondStat?.tokenInFtm) < 1.01, [bondStat]);\n  const grapeReserves = useMemo(() => (Number(bondStat?.treasuryGrapes) / 1e18).toFixed(0), [bondStat]);\n  const bondSupply = useMemo(() => bondStat?.circulatingSupply, [bondStat]);\n  const bondScale = (Number(cashPrice) / 1e18).toFixed(2);\n\n  const [modalOpen, setModalOpen] = useState(false);\n\n  const handleCloseModal = () => {\n    setModalOpen(false);\n  };\n\n  const handleOpenModal = () => {\n    setModalOpen(true);\n  };\n\n  return (\n    <Switch>\n      <Page>\n        {!!account ? (\n          <>\n            {memoizedBondBalance && (\n              <BondEstimatorModal\n                open={modalOpen}\n                walletBondAmount={Number(memoizedBondBalance) / Math.pow(10, 18)}\n                handleClose={handleCloseModal}\n              />\n            )}\n            <Typography color=\"textPrimary\" align=\"center\" variant=\"h3\" gutterBottom>\n              Buy & Redeem Bonds\n            </Typography>\n            <Typography color=\"textPrimary\" align=\"center\" variant=\"h6\" gutterBottom style={{marginBottom: '40px'}}>\n              Exchange Grapes for Bonds and burns Grape supply\n              <br />\n              Exchange Bonds for Grapes and earn premiums upon redemption\n            </Typography>\n            <Box mt={2}>\n              <Grid item xs={12} sm={12} justify=\"center\" style={{margin: '18px', display: 'flex'}}>\n                <Alert variant=\"filled\" severity=\"error\">\n                  <b>Bonds are emitted & premiums redeemable based on last epoch TWAP prices not the current TWAP!</b>\n                </Alert>\n              </Grid>\n            </Box>\n            <MetarialBox\n              onClick={handleOpenModal}\n              sx={{\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'flex-end',\n                gap: '2px',\n                cursor: 'pointer',\n              }}\n            >\n              <Typography style={{fontSize: '15px', color: 'white'}}>\n                <u>Estimate your GBonds redeem bonus</u>\n              </Typography>\n              <SwapVerticalCircleIcon style={{color: 'white'}} />\n            </MetarialBox>\n            <StyledBond>\n              <StyledCardWrapper>\n                <ExchangeCard\n                  action=\"Purchase\"\n                  fromToken={grapeFinance.GRAPE}\n                  fromTokenName=\"GRAPE\"\n                  toToken={grapeFinance.GBOND}\n                  toTokenName=\"GBOND\"\n                  priceDesc={\n                    !isBondPurchasable\n                      ? 'GRAPE is over peg'\n                      : getDisplayBalance(bondsPurchasable, 18, 4) + ' GBOND available for purchase'\n                  }\n                  onExchange={handleBuyBonds}\n                />\n              </StyledCardWrapper>\n              <StyledStatsWrapper>\n                <ExchangeStat\n                  tokenName=\"1 GRAPE\"\n                  description=\"Last-Hour TWAP Price\"\n                  //price={Number(grapeStat?.tokenInFtm).toFixed(4) || '-'}\n                  price={bondScale + ' GBOND' || '-'}\n                />\n                <Spacer size=\"md\" />\n                <ExchangeStat\n                  tokenName=\"1 GBOND\"\n                  description=\"Bond Price\"\n                  price={Number(bondStat?.tokenInFtm).toFixed(2) + ' GRAPE' || '-'}\n                />\n\n                <Box mt={3}>\n                  <Grid item xs={12} sm={12} justify=\"center\" style={{display: 'flex'}}>\n                    <Alert variant=\"filled\" severity=\"error\">\n                      <b>Grape Reserves:</b>{' '}\n                      {bondStat?.treasuryGrapes ? roundAndFormatNumber(Number(grapeReserves), 0) : '-'}\n                      <br></br>\n                      <b>Bond supply:</b>{' '}\n                      {bondStat?.circulatingSupply ? roundAndFormatNumber(Number(bondSupply), 0) : '-'} <br></br>\n                      <b>When reserves are {'>'} bond supply debt phase has finished</b>\n                    </Alert>\n                  </Grid>\n                </Box>\n              </StyledStatsWrapper>\n              <StyledCardWrapper>\n                <ExchangeCard\n                  action=\"Redeem\"\n                  fromToken={grapeFinance.GBOND}\n                  fromTokenName=\"GBOND\"\n                  toToken={grapeFinance.GRAPE}\n                  toTokenName=\"GRAPE\"\n                  priceDesc={`${getDisplayBalance(bondBalance)} GBOND Available in wallet`}\n                  onExchange={handleRedeemBonds}\n                  disabledDescription={!isBondRedeemable ? `Enabled when 1 GRAPE > $${BOND_REDEEM_PRICE}` : null}\n                />\n              </StyledCardWrapper>\n            </StyledBond>\n          </>\n        ) : (\n          <UnlockWallet />\n        )}\n      </Page>\n    </Switch>\n  );\n};\n\nconst StyledBond = styled.div`\n  display: flex;\n  @media (max-width: 768px) {\n    width: 100%;\n    flex-flow: column nowrap;\n    align-items: center;\n  }\n`;\n\nconst StyledCardWrapper = styled.div`\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  @media (max-width: 768px) {\n    width: 80%;\n  }\n`;\n\nconst StyledStatsWrapper = styled.div`\n  display: flex;\n  flex: 0.8;\n  margin: 0 20px;\n  flex-direction: column;\n\n  @media (max-width: 768px) {\n    width: 80%;\n    margin: 16px 0;\n  }\n`;\n\nexport default Bond;\n","import {TransactionResponse} from '@ethersproject/providers';\nimport {useCallback, useMemo} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {useWallet} from 'use-wallet';\n\nimport {AppDispatch, AppState} from '../index';\nimport {addTransaction, clearAllTransactions} from './actions';\nimport {TransactionDetails} from './reducer';\n\n// helper that can take a ethers library transaction response and add it to the list of transactions\nexport function useTransactionAdder(): (\n  response: TransactionResponse,\n  customData?: {summary?: string; approval?: {tokenAddress: string; spender: string}},\n) => void {\n  const {chainId, account} = useWallet();\n  const dispatch = useDispatch<AppDispatch>();\n\n  return useCallback(\n    (\n      response: TransactionResponse,\n      {summary, approval}: {summary?: string; approval?: {tokenAddress: string; spender: string}} = {},\n    ) => {\n      if (!account) return;\n      if (!chainId) return;\n\n      const {hash} = response;\n\n      if (!hash) {\n        throw Error('No transaction hash found.');\n      }\n      dispatch(addTransaction({hash, from: account, chainId, approval, summary}));\n    },\n    [dispatch, chainId, account],\n  );\n}\n\n// returns all the transactions for the current chain\nexport function useAllTransactions(): {[txHash: string]: TransactionDetails} {\n  const {chainId} = useWallet();\n  const state = useSelector<AppState, AppState['transactions']>((state) => state.transactions);\n\n  return chainId ? state[chainId] ?? {} : {};\n}\n\nexport function useIsTransactionPending(transactionHash?: string): boolean {\n  const transactions = useAllTransactions();\n  if (!transactionHash || !transactions[transactionHash]) {\n    return false;\n  }\n\n  return !transactions[transactionHash].receipt;\n}\n\n/**\n * Returns whether a transaction happened in the last day (86400 seconds * 1000 milliseconds / second)\n * @param tx to check for recency\n */\nexport function isTransactionRecent(tx: TransactionDetails): boolean {\n  return new Date().getTime() - tx.addedTime < 86_400_000;\n}\n\n// returns whether a token has a pending approval transaction\nexport function useHasPendingApproval(tokenAddress: string | undefined, spender: string | undefined): boolean {\n  const allTransactions = useAllTransactions();\n  return useMemo(\n    () =>\n      typeof tokenAddress === 'string' &&\n      typeof spender === 'string' &&\n      Object.keys(allTransactions).some((hash) => {\n        const tx = allTransactions[hash];\n        if (!tx) return false;\n        if (tx.receipt) {\n          return false;\n        } else {\n          const approval = tx.approval;\n          if (!approval) return false;\n          return approval.spender === spender && approval.tokenAddress === tokenAddress && isTransactionRecent(tx);\n        }\n      }),\n    [allTransactions, spender, tokenAddress],\n  );\n}\n\nexport function useClearAllTransactions(): {clearAllTransactions: () => void} {\n  const {chainId} = useWallet();\n  const dispatch = useDispatch<AppDispatch>();\n  return {\n    clearAllTransactions: useCallback(() => dispatch(clearAllTransactions({chainId})), [dispatch, chainId]),\n  };\n}\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst ModalActions: React.FC = ({children}) => {\n  const l = React.Children.toArray(children).length;\n  return (\n    <StyledModalActions>\n      {React.Children.map(children, (child, i) => (\n        <>\n          <StyledModalAction>{child}</StyledModalAction>\n          {i < l - 1 && <StyledSpacer />}\n        </>\n      ))}\n    </StyledModalActions>\n  );\n};\n\nconst StyledModalActions = styled.div`\n  align-items: center;\n  background-color: ${(props) => props.theme.color.grey[100]}00;\n  display: flex;\n  height: 96px;\n  margin: ${(props) => props.theme.spacing[4]}px ${(props) => -props.theme.spacing[4]}px\n    ${(props) => -props.theme.spacing[4]}px;\n  padding: 0 ${(props) => props.theme.spacing[4]}px;\n`;\n\nconst StyledModalAction = styled.div`\n  flex: 1;\n`;\n\nconst StyledSpacer = styled.div`\n  width: ${(props) => props.theme.spacing[4]}px;\n`;\n\nexport default ModalActions;\n","import {BigNumber, ethers} from 'ethers';\nimport {useCallback, useMemo} from 'react';\nimport {useHasPendingApproval, useTransactionAdder} from '../state/transactions/hooks';\nimport useAllowance from './useAllowance';\nimport ERC20 from '../grape-finance/ERC20';\nimport {publish} from '../state/txEvent';\n\nconst APPROVE_AMOUNT = ethers.constants.MaxUint256;\nconst APPROVE_BASE_AMOUNT = BigNumber.from('1000000000000000000000000');\n\nexport enum ApprovalState {\n  UNKNOWN,\n  NOT_APPROVED,\n  PENDING,\n  APPROVED,\n}\n\n// returns a variable indicating the state of the approval and a function which approves if necessary or early returns\nfunction useApprove(token: ERC20, spender: string) {\n  const pendingApproval = useHasPendingApproval(token.address, spender);\n  const currentAllowance = useAllowance(token, spender, pendingApproval);\n\n  // check the current approval status\n  const approveStatus: ApprovalState = useMemo(() => {\n    // we might not have enough data to know whether or not we need to approve\n    if (!currentAllowance) return ApprovalState.UNKNOWN;\n\n    // amountToApprove will be defined if currentAllowance is\n    return currentAllowance.lt(APPROVE_BASE_AMOUNT)\n      ? pendingApproval\n        ? ApprovalState.PENDING\n        : ApprovalState.NOT_APPROVED\n      : ApprovalState.APPROVED;\n  }, [currentAllowance, pendingApproval]);\n\n  const addTransaction = useTransactionAdder();\n\n  const approve = useCallback(async (): Promise<void> => {\n    if (approveStatus !== ApprovalState.NOT_APPROVED) {\n      console.error('approve was called unnecessarily');\n      return;\n    }\n\n    try {\n      const response = await token.approve(spender, APPROVE_AMOUNT);\n      addTransaction(response, {\n        summary: `Approve ${token.symbol}`,\n        approval: {\n          tokenAddress: token.address,\n          spender: spender,\n        },\n      });\n    } catch (e) {\n      publish('failedTx');\n    }\n  }, [approveStatus, token, spender, addTransaction]);\n\n  return {approveStatus, approve};\n}\n\nexport default useApprove;\n","import React from 'react';\nimport styled from 'styled-components';\n\nexport interface InputProps {\n  endAdornment?: React.ReactNode;\n  onChange: (e: React.FormEvent<HTMLInputElement>) => void;\n  placeholder?: string;\n  startAdornment?: React.ReactNode;\n  value: string;\n}\n\nconst Input: React.FC<InputProps> = ({endAdornment, onChange, placeholder, startAdornment, value}) => {\n  return (\n    <StyledInputWrapper>\n      {!!startAdornment && startAdornment}\n      <StyledInput placeholder={placeholder} type=\"number\" value={value} onChange={onChange} />\n      {!!endAdornment && endAdornment}\n    </StyledInputWrapper>\n  );\n};\n\nconst StyledInputWrapper = styled.div`\n  align-items: center;\n  background-color: ${(props) => props.theme.color.grey[200]};\n  border-radius: ${(props) => props.theme.borderRadius}px;\n  display: flex;\n  padding: 0 ${(props) => props.theme.spacing[3]}px;\n`;\n\nconst StyledInput = styled.input`\n  background: none;\n  border: 0;\n  color: ${(props) => props.theme.color.grey[600]};\n  font-size: 18px;\n  flex: 1;\n  height: 56px;\n  margin: 0;\n  padding: 0;\n  outline: none;\n`;\n\nexport default Input;\n","import React from 'react';\nimport styled from 'styled-components';\n\nimport {Button} from '@material-ui/core';\nimport Input, {InputProps} from '../Input';\n\ninterface TokenInputProps extends InputProps {\n  max: number | string;\n  symbol: string;\n  onSelectMax?: () => void;\n}\n\nconst TokenInput: React.FC<TokenInputProps> = ({max, symbol, onChange, onSelectMax, value}) => {\n  return (\n    <StyledTokenInput>\n      <StyledMaxText>\n        {max.toLocaleString()} {symbol} Available\n      </StyledMaxText>\n      <Input\n        endAdornment={\n          <StyledTokenAdornmentWrapper>\n            {/* <StyledTokenSymbol>{symbol}</StyledTokenSymbol> */}\n            <StyledSpacer />\n            <div>\n              <Button size=\"small\" color=\"primary\" variant=\"contained\" onClick={onSelectMax}>\n                <span style={{color: \"#fff\"}}>Max</span>\n              </Button>\n            </div>\n          </StyledTokenAdornmentWrapper>\n        }\n        onChange={onChange}\n        placeholder=\"0\"\n        value={value}\n      />\n    </StyledTokenInput>\n  );\n};\n\n/*\n            <div>\n              <Button size=\"sm\" text=\"Max\" />\n            </div>\n*/\n\nconst StyledTokenInput = styled.div``;\n\nconst StyledSpacer = styled.div`\n  width: ${(props) => props.theme.spacing[3]}px;\n`;\n\nconst StyledTokenAdornmentWrapper = styled.div`\n  align-items: center;\n  display: flex;\n`;\n\nconst StyledMaxText = styled.div`\n  align-items: center;\n  color: #fff;\n  display: flex;\n  font-size: 14px;\n  font-weight: 700;\n  height: 44px;\n  justify-content: flex-end;\n`;\n\nexport default TokenInput;\n","//@ts-nocheck\nimport React from 'react';\nimport {Box} from '@material-ui/core';\nimport AccountButton from '../Page/AccountButton';\n\nconst UnlockWallet = () => {\n  return (\n    <Box display={'flex'} alignItems={'center'} justifyContent=\"center\">\n      <AccountButton />\n    </Box>\n  );\n};\n\nexport default UnlockWallet;\n","import {useCallback, useEffect, useState} from 'react';\nimport {useWallet} from 'use-wallet';\nimport {BigNumber} from 'ethers';\nimport ERC20 from '../grape-finance/ERC20';\n\nconst useAllowance = (token: ERC20, spender: string, pendingApproval?: boolean) => {\n  const [allowance, setAllowance] = useState<BigNumber>(null);\n  const {account} = useWallet();\n\n  const fetchAllowance = useCallback(async () => {\n    const allowance = await token.allowance(account, spender);\n    setAllowance(allowance);\n  }, [account, spender, token]);\n\n  useEffect(() => {\n    if (account && spender && token) {\n      fetchAllowance().catch((err) => console.error(`Failed to fetch allowance: ${err.stack}`));\n    }\n  }, [account, spender, token, pendingApproval, fetchAllowance]);\n\n  return allowance;\n};\n\nexport default useAllowance;\n","import React, {useContext, useMemo} from 'react';\nimport styled, {ThemeContext} from 'styled-components';\n\nimport {Link} from 'react-router-dom';\n\ninterface ButtonProps {\n  children?: React.ReactNode;\n  disabled?: boolean;\n  href?: string;\n  onClick?: () => void;\n  size?: 'sm' | 'md' | 'lg';\n  text?: string;\n  to?: string;\n  variant?: 'default' | 'secondary' | 'tertiary';\n}\n\nconst Button: React.FC<ButtonProps> = ({children, disabled, href, onClick, size, text, to, variant}) => {\n  const {color, spacing} = useContext(ThemeContext);\n\n  let buttonColor: string;\n  switch (variant) {\n    case 'secondary':\n      buttonColor = color.teal[200];\n      break;\n    case 'default':\n    default:\n      buttonColor = color.primary.main;\n  }\n\n  let boxShadow: string;\n  let buttonSize: number;\n  let buttonPadding: number;\n  let fontSize: number;\n  switch (size) {\n    case 'sm':\n      buttonPadding = spacing[3];\n      buttonSize = 36;\n      fontSize = 14;\n      break;\n    case 'lg':\n      buttonPadding = spacing[4];\n      buttonSize = 72;\n      fontSize = 16;\n      break;\n    case 'md':\n    default:\n      buttonPadding = spacing[4];\n      buttonSize = 56;\n      fontSize = 16;\n  }\n\n  const ButtonChild = useMemo(() => {\n    if (to) {\n      return <StyledLink to={to}>{text}</StyledLink>;\n    } else if (href) {\n      return (\n        <StyledExternalLink href={href} target=\"__blank\">\n          {text}\n        </StyledExternalLink>\n      );\n    } else {\n      return text;\n    }\n  }, [href, text, to]);\n\n  return (\n    <StyledButton\n      boxShadow={boxShadow}\n      color={buttonColor}\n      disabled={disabled}\n      fontSize={fontSize}\n      onClick={onClick}\n      padding={buttonPadding}\n      size={buttonSize}\n    >\n      {children}\n      {ButtonChild}\n    </StyledButton>\n  );\n};\n\ninterface StyledButtonProps {\n  boxShadow: string;\n  color: string;\n  disabled?: boolean;\n  fontSize: number;\n  padding: number;\n  size: number;\n}\n\nconst StyledButton = styled.button<StyledButtonProps>`\n  align-items: center;\n  background-color: ${(props) => props.theme.color.grey[900]};\n  border: 0;\n  border-radius: 12px;\n  box-shadow: ${(props) => props.boxShadow};\n  color: ${(props) => (!props.disabled ? props.color : `${props.color}55`)};\n  cursor: pointer;\n  display: flex;\n  font-size: ${(props) => props.fontSize}px;\n  font-weight: 700;\n  height: ${(props) => props.size}px;\n  justify-content: center;\n  outline: none;\n  padding-left: ${(props) => props.padding}px;\n  padding-right: ${(props) => props.padding}px;\n  pointer-events: ${(props) => (!props.disabled ? undefined : 'none')};\n  width: 100%;\n  &:hover {\n    background-color: ${(props) => props.color};\n    color: ${(props) => props.theme.color.grey[900]};\n  }\n`;\n\nconst StyledLink = styled(Link)`\n  align-items: center;\n  color: inherit;\n  display: flex;\n  flex: 1;\n  height: 56px;\n  justify-content: center;\n  margin: 0 ${(props) => -props.theme.spacing[4]}px;\n  padding: 0 ${(props) => props.theme.spacing[4]}px;\n  text-decoration: none;\n`;\n\nconst StyledExternalLink = styled.a`\n  align-items: center;\n  color: inherit;\n  display: flex;\n  flex: 1;\n  height: 56px;\n  justify-content: center;\n  margin: 0 ${(props) => -props.theme.spacing[4]}px;\n  padding: 0 ${(props) => props.theme.spacing[4]}px;\n  text-decoration: none;\n`;\n\nexport default Button;\n","export function round(value: number, precision: number) {\n  var multiplier = Math.pow(10, precision || 0);\n  return Math.round(value * multiplier) / multiplier;\n}\n\nexport function formatNumber(inputNumber: number): string {\n  var ret = inputNumber.toString();\n  var expr = /\\B(?=(\\d{3})+(?!\\d))/g;\n  if (ret.indexOf('.') === -1) {\n    ret = ret.replace(expr, ',');\n  } else {\n    var split = ret.split('.');\n    var left = split[0].replace(expr, ',');\n    var right = split[1];\n    if (right.length === 1 && right !== '0') {\n      right += '0';\n    }\n\n    ret = `${left}.${right}`;\n  }\n\n  return ret;\n}\n\nexport function roundAndFormatNumber(value: number, precision: number): string {\n  var ret = '';\n\n  var rounded = round(value, precision);\n  var formatted = formatNumber(rounded);\n  ret = formatted;\n\n  return ret;\n}\n","import {useEffect, useState} from 'react';\nimport useGrapeFinance from './useGrapeFinance';\nimport {TokenStat} from '../grape-finance/types';\nimport useRefresh from './useRefresh';\n\nconst useBondStats = () => {\n  const [stat, setStat] = useState<TokenStat>();\n  const {slowRefresh} = useRefresh();\n  const grapeFinance = useGrapeFinance();\n\n  useEffect(() => {\n    async function fetchBondPrice() {\n      try {\n        setStat(await grapeFinance.getBondStat());\n      } catch (err) {\n        console.error(err);\n      }\n    }\n    fetchBondPrice();\n  }, [setStat, grapeFinance, slowRefresh]);\n\n  return stat;\n};\n\nexport default useBondStats;\n","import {useCallback, useEffect, useState} from 'react';\nimport useGrapeFinance from './useGrapeFinance';\nimport config from '../config';\nimport {BigNumber} from 'ethers';\n\nconst useCashPriceInLastTWAP = () => {\n  const [price, setPrice] = useState<BigNumber>(BigNumber.from(0));\n  const grapeFinance = useGrapeFinance();\n\n  const fetchCashPrice = useCallback(async () => {\n    setPrice(await grapeFinance.getGrapePriceInLastTWAP());\n  }, [grapeFinance]);\n\n  useEffect(() => {\n    fetchCashPrice().catch((err) => console.error(`Failed to fetch GRAPE price: ${err.stack}`));\n    const refreshInterval = setInterval(fetchCashPrice, config.refreshInterval);\n    return () => clearInterval(refreshInterval);\n  }, [setPrice, grapeFinance, fetchCashPrice]);\n\n  return price;\n};\n\nexport default useCashPriceInLastTWAP;\n"],"sourceRoot":""}